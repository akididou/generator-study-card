<div class="form-container">
  <h2>Informations de l'étudiant</h2>

  <form (ngSubmit)="onSubmit()" #studentForm="ngForm" class="student-form">
    <div class="form-group">
      <label for="nom">Nom <span class="required">*</span></label>
      <input
        type="text"
        id="nom"
        name="nom"
        [(ngModel)]="student.nom"
        required
        maxlength="50"
        pattern="[A-Za-zÀ-ÿ\s\-']+"
        class="form-control"
        placeholder="Entrez le nom de famille"
      >
    </div>

    <div class="form-group">
      <label for="prenom">Prénom <span class="required">*</span></label>
      <input
        type="text"
        id="prenom"
        name="prenom"
        [(ngModel)]="student.prenom"
        required
        maxlength="50"
        pattern="[A-Za-zÀ-ÿ\s\-']+"
        class="form-control"
        placeholder="Entrez le prénom"
      >
    </div>

    <div class="form-group">
      <label for="dateNaissance">Date de naissance <span class="required">*</span></label>
      <input
        type="date"
        id="dateNaissance"
        name="dateNaissance"
        [(ngModel)]="student.dateNaissance"
        required
        class="form-control"
        [max]="getTodayDate()"
      >
    </div>

    <div class="form-group">
      <label for="photo">Photo <span class="required">*</span></label>
      <div class="file-input-container">
        <input
          type="file"
          id="photo"
          name="photo"
          (change)="onFileSelected($event)"
          accept="image/jpeg,image/jpg,image/png"
          required
          class="file-input"
        >
        <div class="file-input-info">
          <small>Format accepté : JPG, JPEG, PNG (max 5MB)</small>
          <small *ngIf="selectedFile" class="file-selected">
            Fichier sélectionné : {{ selectedFile.name }}
          </small>
        </div>
      </div>
    </div>

    <div class="form-group">
      <label for="signatureType">Type de signature <span class="required">*</span></label>
      <div class="signature-type-container">
        <div class="radio-group">
          <input
            type="radio"
            id="signatureAuto"
            name="signatureType"
            value="auto"
            [(ngModel)]="student.signatureType"
            (change)="onSignatureTypeChange()"
            class="radio-input"
          >
          <label for="signatureAuto" class="radio-label">
            <span class="radio-indicator"></span>
            <div class="radio-content">
              <strong>Signature automatique</strong>
              <small>Générée automatiquement à partir de votre nom</small>
            </div>
          </label>
        </div>

        <div class="radio-group">
          <input
            type="radio"
            id="signatureManual"
            name="signatureType"
            value="manual"
            [(ngModel)]="student.signatureType"
            (change)="onSignatureTypeChange()"
            class="radio-input"
          >
          <label for="signatureManual" class="radio-label">
            <span class="radio-indicator"></span>
            <div class="radio-content">
              <strong>Signature manuelle</strong>
              <small>Dessinez votre propre signature</small>
            </div>
          </label>
        </div>
      </div>
    </div>

    <!-- Signature manuelle component -->
    <div class="form-group" *ngIf="student.signatureType === 'manual'">
      <app-signature-pad
        (signatureChanged)="onManualSignatureChange($event)">
      </app-signature-pad>

      <div class="signature-validation" *ngIf="student.signatureType === 'manual' && !manualSignatureData">
        <small class="validation-message">
          ⚠️ Veuillez dessiner votre signature pour continuer
        </small>
      </div>
    </div>

    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>

    <div class="form-actions">
      <button
        type="submit"
        [disabled]="!studentForm.valid || isLoading"
        class="btn btn-primary"
      >
        <span *ngIf="isLoading" class="loading-spinner"></span>
        {{ isLoading ? 'Traitement...' : 'Générer la carte' }}
      </button>

      <button
        type="button"
        (click)="resetForm()"
        class="btn btn-secondary"
        [disabled]="isLoading"
      >
        Réinitialiser
      </button>
    </div>
  </form>
</div>